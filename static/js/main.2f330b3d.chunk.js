(this["webpackJsonpplanet-accessibility-explorer"]=this["webpackJsonpplanet-accessibility-explorer"]||[]).push([[0],{183:function(e,t,r){},235:function(e,t,r){},236:function(e,t,r){"use strict";r.r(t);var n=r(109),i=r.n(n),o=r(83),s=r(0),a=r.n(s),c=r(20),l=r.n(c),d=r(117),u=r(243),p=r(241),b=r(242),j=r(12),f=r(42),h=(r(183),r(46)),m=r(37),O=r(3);function g(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}function x(e){var t=function(){var e=s.useState(g()),t=Object(m.a)(e,2),r=t[0],n=t[1],i=s.useCallback((function(e){n(g())}),[]);return s.useEffect((function(){void 0!==window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i)}),[i]),r}();return Object(O.jsx)("div",Object(h.a)(Object(h.a)({},e),{},{className:t?"".concat(e.className," bp3-dark"):e.className,children:e.children}))}var v=function(e,t){return e.reduce((function(e,t){var r=Object(m.a)(t,2),n=r[0],i=r[1];return Object(O.jsx)(n.Provider,{value:i,children:e})}),t)};var y=r(56),w=r.n(y),k=r(35),_=(r(204),r(118)),$=r(7),S=r(24),I=r(44);var N=r(69);function L(e){return Object(O.jsx)("li",{className:$.LIST_UNSTYLED,children:Object(O.jsx)("a",{rel:"noreferrer",target:"_blank",href:e.href,children:e.children})})}var E=r(110),C=r.n(E);function D(e){const{feature:t}=e;return Object(O.jsx)("address",{children:C()(Object(S.compact)(["street","housenumber","place","postcode","city","suburb","county","state","country"].map((e=>`addr:${e}`)).map((e=>t.properties[e]&&Object(O.jsx)("span",{children:t.properties[e]})))),Object(O.jsx)("span",{children:", "}))})}const T=e=>fetch(e).then((e=>e.json()));function F(e){const{[e.prefix?`${e.prefix}:wikidata`:"wikidata"]:t}=e.feature.properties,r=`https://query.wikidata.org/sparql?query=SELECT%20%3Fo%0AWHERE%20%7B%0A%20%20%20%20wd%3A${encodeURIComponent(t)}%20wdt%3A${e.verb}%20%3Fo.%0A%7D&format=json`,{data:n,error:i}=Object(I.a)(t?r:null,T);if(i)return null;if(!n)return null;try{const{results:t}=n,{bindings:r}=t,{o:i}=r[0],{value:o}=i,s=`${o.replace(/^http:/,"https:")}?width=200`;return Object(O.jsx)("img",{...Object(S.omit)(e,"feature","prefix","verb"),src:s})}catch(o){return null}}function M(e){var t,r;let n;const i=null===(t=e.fileName)||void 0===t||null===(r=t.match(/^(?:(?:https?)\/\/commons.wikimedia.org\/wiki\/)?File:(.*)/i))||void 0===r?void 0:r[0];return i&&(n=`https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(i)}?width=200`),n?Object(O.jsx)("img",{...Object(S.omit)(e,"fileName"),src:n,alt:e.fileName}):null}function z({feature:e,prefix:t,...r}){const n=e.properties[t?`${t}:wikipedia`:"wikipedia"];if(!n)return null;const[i,o]=n.split(":");return i&&o?Object(O.jsx)("a",{href:`https://${i}.wikipedia.org/wiki/${o}`,target:"_blank",rel:"noopener noreferrer",...r}):Object(O.jsx)(O.Fragment,{children:r.children})}function P({feature:e}){const t={margin:"0 0 0 1rem",maxHeight:"5.25rem",maxWidth:"5.25rem"};return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(z,{feature:e,children:Object(O.jsx)(F,{feature:e,style:t,verb:"P18"})}),Object(O.jsx)(z,{feature:e,prefix:"subject",children:Object(O.jsx)(F,{feature:e,style:t,prefix:"subject",verb:"P18"})}),Object(O.jsx)(z,{feature:e,prefix:"brand",children:Object(O.jsx)(F,{feature:e,style:t,prefix:"brand",verb:"P154"})}),Object(O.jsx)(z,{feature:e,prefix:"operator",children:Object(O.jsx)(F,{feature:e,style:t,prefix:"operator",verb:"P154"})}),Object(O.jsx)(M,{fileName:e.properties.image,style:t})]})}const W=new Set(["access","acoustic","air_conditioning","amperage","automatic_door","barrier","bicycle","blind","blind:description","braille","building:levels","capacity","centralkey","changing_table","charge","crossing","cycleway","deaf","delivery","description:payment","diet","disabled","dispensing","dog","door","drinking_water","elevator","embossed_letters","emergency","entrance","fee","female","floating","foot","gay","handrail","indoor","information","internet_access","kerb","lesbian","level","lgbtq","lit","location","male","material","max_age","min_age","opening_hours","outdoor_seating","parking","payment","ramp","represented_date","reservation","room","scale","self_service","sidewalk","sloped_curb","smoking","smoothness","socket","speech_output","step_count","stroller","surface","surveillance","tactile_paving","tactile_writing","takeaway","toilet","toilets","traffic_signals","unisex","voice_description","voltage","wheelchair","wheelchair:description","width","winter_service"]);function A(e){return W.has(e)||W.has(e.substr(0,e.indexOf(":")))}const U=new Set(["addr"]);function B(e){return U.has(e)||U.has(e.substr(0,e.indexOf(":")))}const K=Object(f.a)("table")`
  background-color: rgba(0, 0, 0, 0.05);
  margin: 1rem 0;
`;function R(e){return Object(O.jsx)(K,{className:[$.HTML_TABLE,$.HTML_TABLE_STRIPED,$.HTML_TABLE_CONDENSED].join(" "),children:e.keys.map((t=>Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:t}),Object(O.jsx)("td",{children:e.feature.properties[t]})]},t)))})}const Y=(e,t)=>fetch(e,t).then((e=>e.json()));function Z(){return Object(O.jsx)("div",{className:"bp3-skeleton",children:"Loading..."})}const G=["type","name","area"];function q(e){const{featureId:t}=e,r=`https://ac-osm.global.ssl.fastly.net/api/v1/${t.source}/${t.id}.json`,{data:n,error:i}=Object(I.a)(r,Y);if(i)return Object(O.jsx)(b.a,{intent:"danger",children:JSON.stringify(i)});if(!n)return Object(O.jsx)(Z,{});if(void 0!==n.error)return Object(O.jsx)(b.a,{intent:"danger",children:JSON.stringify(n)});const o=Object.keys(n.properties).sort().sort(((e,t)=>e.startsWith("name")?-1:t.startsWith("name")?1:0)).filter((e=>!G.find((t=>e.startsWith(t))))),s=o.filter(A),a=o.filter(B),c=Object(S.difference)(o,s,a),l="Point"===n.geometry.type?"node":n._id.startsWith("-")?"relation":"way",d=n._id.replace(/^-/,""),u=function(e){const t=e.properties,r=t.name||t.loc_name||t.description||t.ref;if(r)return r}(n),p=function(e){const t=e.properties,r=["studio","office","shop","room","building","landuse","route"],n=["sport","leisure","tourism","shop","amenity","junction","railway","aeroway","man_made","highway"];for(const i of n)if(t[i]&&"yes"!==t[i])return`${Object(N.humanize)(t[i])} ${t.ref||""}`;for(const i of r)if(t[i]&&"yes"!==t[i])return`${Object(N.humanize)(t[i])} ${i} ${t.ref||""}`;for(const i of r)if("yes"===t[i])return t.note||`${Object(N.humanize)(i)} ${t.ref||t.note||""}`}(n);return Object(O.jsxs)(b.b,{style:{gap:"10px",maxWidth:"40rem"},children:[Object(O.jsxs)("header",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Object(O.jsxs)("div",{children:[Object(O.jsx)(b.c,{children:u||p}),u&&p&&Object(O.jsx)("p",{style:{fontWeight:"bold"},children:p}),n.properties.description&&Object(O.jsx)("p",{children:n.properties.description}),Object(O.jsx)(D,{feature:n})]}),Object(O.jsx)(P,{feature:n})]}),Object(O.jsx)(R,{keys:s,feature:n}),Object(O.jsxs)("details",{children:[Object(O.jsx)("summary",{children:"See OpenStreetMap information"}),Object(O.jsx)("h3",{children:"OSM tags"}),Object(O.jsx)(R,{keys:c,feature:n}),Object(O.jsxs)(b.e,{className:$.LIST_UNSTYLED,children:[Object(O.jsx)(L,{href:`https://openstreetmap.org/${l}/${d}`,children:"Open on OpenStreetMap"}),"relation"!==l&&Object(O.jsx)(L,{href:`https://wheelmap.org/nodes/${"way"===l?"-":""}${d}`,children:"Open on Wheelmap"}),Object(O.jsx)(L,{href:`https://www.openstreetmap.org/edit?${l}=${d}#map=19/${n.centroid.coordinates[1]}/${n.centroid.coordinates[0]}`,children:"Edit with ID Editor"}),Object(O.jsx)(L,{href:`https://ac-osm.global.ssl.fastly.net/api/v1/${t.source}/${t.id}.geojson`,children:"Show GeoJSON"})]})]})]})}function J(e){const{featureIds:t}=e,r=Object(S.uniqBy)(t,(e=>e.id)),n=Object(O.jsx)(b.e,{className:$.LIST_UNSTYLED,children:r.map((e=>Object(O.jsx)("li",{className:$.LIST_UNSTYLED,children:Object(O.jsx)(q,{featureId:e})},`${e.source}/${e.id}`)))});return Object(O.jsx)(k.d,{latitude:e.latitude,longitude:e.longitude,closeButton:!0,closeOnClick:!1,onClose:e.onClose,anchor:"top",children:n})}var H,V=r(116),Q=f.a.div(H||(H=Object(V.a)(["\n  overflow: auto;\n"]))),X=["admin","places","amenities","entrances_or_exits","elevators","ramps","pedestrian_highways","conveying","toilets","buildings","master_routes","master_route_members","routes","route_members","stop_areas","stop_area_members","platforms","stop_positions","stations"];var ee=function(e,t){return fetch(e,t).then((function(e){return e.json()}))};var te=function(){var e="https://api.mapbox.com/styles/v1/".concat("sozialhelden","/").concat("ckwdrjpmz4jox16o7libit9p4","?fresh=true&access_token=").concat("pk.eyJ1Ijoic296aWFsaGVsZGVuIiwiYSI6ImNrd2Y1M3hoMDBiY3IyeG5zbzZ3ZXR6ZXIifQ.qQ8nPyopGZKyEM4DP5aKgA"),t=Object(I.a)(e,ee),r=t.data,n=t.error;return n?{error:n}:r?{data:r}:{loading:!0}};function re(){return s.useContext(k.b).map,null}function ne(e){var t,r;const[n,{width:i,height:o}]=Object(_.a)(),a=Object(s.useRef)(null),c=Object(j.d)(),l=Object(j.e)(),d=function(e){const t=e.pathname.match(/^\/(\w+)\/([\w,:-]+)/);let r=[];if(t&&"string"===typeof t[1]&&"string"===typeof t[2]){const e=t[2];r="composite"===t[1]?Object(S.uniq)(e.split(",").sort()).map((e=>{const[t,r]=e.split(":");return{source:t,id:r}})):[{source:t[1],id:e}]}return r}(l),u=new URLSearchParams(l.search),p=u.get("lat"),b=u.get("lon"),f=u.get("zoom"),[m,g]=Object(s.useState)({width:100,height:100,latitude:p&&parseFloat(p)||52.5,longitude:b&&parseFloat(b)||13.3,zoom:f&&parseFloat(f)||(p&&b?18:10)});Object(s.useLayoutEffect)((()=>{const e={...m,width:i,height:o};g(e)}),[i,o]);const x=Object(s.useCallback)((e=>{var t,r;console.log(e);const n=null===e||void 0===e||null===(t=e.features)||void 0===t?void 0:t.length;if(n||c.push("/"),1!==n)c.push(`/composite/${null===(r=e.features)||void 0===r?void 0:r.map((e=>[e.source,e.properties.id].join(":"))).join(",")}?lon=${e.lngLat[0]}&lat=${e.lngLat[1]}&zoom=${f}`);else{var i;const t=null===(i=e.features)||void 0===i?void 0:i[0];t&&c.push(`/${t.source}/${t.properties.id}?lon=${e.lngLat[0]}&lat=${e.lngLat[1]}&zoom=${f}`)}}),[c,f]),v=Object(s.useCallback)((()=>{const e=c.location,t=new URLSearchParams(e.search);m.zoom&&t.set("zoom",m.zoom.toString()),0===d.length&&(m.latitude&&t.set("lat",m.latitude.toString()),m.longitude&&t.set("lon",m.longitude.toString())),e.search=t.toString(),c.replace(e)}),[m,c,d]),y=Object(s.useCallback)((()=>{c.push("/"),v()}),[c,v]),w=Object(s.useCallback)(((e,t)=>{g({...m,...e})}),[g,m]),$=te(),I=s.useMemo((()=>{var e,t;return(null===(e=$.data)||void 0===e?void 0:e.layers)&&function(e){return e.filter((function(e){var t;return null===(t=e.id)||void 0===t?void 0:t.startsWith("osm-")})).map((function(e){var t=X.find((function(t){var r;return null===(r=e["source-layer"])||void 0===r?void 0:r.startsWith(t)}));return Object(h.a)(Object(h.a)({},e),{},{source:t,"source-layer":"default"})})).filter((function(e){return e.source}))}(null===(t=$.data)||void 0===t?void 0:t.layers)}),[$]);return Object(O.jsxs)(Q,{ref:n,className:e.className,style:{flex:1,display:!1===e.visible?"none":"block",position:"relative"},children:[Object(O.jsxs)(k.f,{...m,mapboxApiAccessToken:"pk.eyJ1Ijoic296aWFsaGVsZGVuIiwiYSI6ImNrd2Y1M3hoMDBiY3IyeG5zbzZ3ZXR6ZXIifQ.qQ8nPyopGZKyEM4DP5aKgA",onViewportChange:w,onTransitionEnd:v,onTouchEnd:v,onMouseUp:v,interactiveLayerIds:null===(t=$.data)||void 0===t||null===(r=t.layers)||void 0===r?void 0:r.map((e=>e.id)).filter((e=>e.startsWith("osm-"))),onClick:x,mapStyle:"mapbox://styles/mapbox/light-v10",ref:a,children:[X.map((e=>Object(O.jsx)(k.e,{type:"vector",tiles:[0,1,2,3].map((t=>{var r;return`${null===(r="https://ac-o-{n}.global.ssl.fastly.net/api/v1")?void 0:r.replace(/{n}/,t.toString())}/${e}.mvt?limit=10000&bbox={bbox-epsg-3857}&epsg=3857`})),id:e},e))),null===I||void 0===I?void 0:I.map((e=>Object(O.jsx)(k.a,{...e},e.id))),p&&b&&d.length>0&&Object(O.jsx)(J,{featureIds:d,latitude:Number.parseFloat(p),longitude:Number.parseFloat(b),onClose:y}),Object(O.jsx)(re,{}),Object(O.jsx)(k.c,{style:{right:"1rem",top:"1rem"}})]}),e.children]})}w.a.workerClass=r(231).default,u.a.onlyShowFocusOnTabs();const ie=f.a.div`
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: row;
  align-items: stretch;
`;var oe=function(){const e=[],t=Object(j.d)(),r=Object(j.e)(),n=s.useCallback((e=>{const n=`/features/${e}`;t.push(`${n}${r.search}`)}),[t,r]),i=Object(O.jsx)(ne,{featureId:void 0,onSelectFeature:n,visible:!0}),o=Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(ie,{children:i})}),c=a.a.useMemo((function(){return[{combo:"mod+z",global:!0,label:"Undo",onKeyDown:function(){alert("!!")},allowInInput:!1,preventDefault:!0},{global:!0,combo:"mod+shift+z",label:"Redo",onKeyDown:function(){alert("!!")},allowInInput:!1,preventDefault:!0}]}),[]);return Object(O.jsx)(p.b,{children:Object(O.jsx)(b.d,{hotkeys:c,children:({handleKeyDown:t,handleKeyUp:r})=>Object(O.jsx)(x,{style:{height:"100%",display:"flex",flexDirection:"column"},onKeyDown:t,onKeyUp:r,children:v(e,o)})})})},se=(r(235),function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,244)).then((function(t){var r=t.getCLS,n=t.getFID,i=t.getFCP,o=t.getLCP,s=t.getTTFB;r(e),n(e),i(e),o(e),s(e)}))});i.a.config(),Object(o.a)(),Object(o.b)(),l.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(d.a,{basename:"/planet-accessibility-explorer",children:Object(O.jsx)(oe,{})})}),document.getElementById("root")),se()}},[[236,1,2]]]);
//# sourceMappingURL=main.2f330b3d.chunk.js.map