(this["webpackJsonpplanet-accessibility-explorer"]=this["webpackJsonpplanet-accessibility-explorer"]||[]).push([[0],{183:function(e,t,r){},235:function(e,t,r){},236:function(e,t,r){"use strict";r.r(t);var n=r(109),i=r.n(n),s=r(83),a=r(0),o=r.n(a),c=r(20),l=r.n(c),d=r(117),u=r(243),p=r(241),b=r(242),h=r(12),j=r(42),f=(r(183),r(46)),m=r(37),O=r(4);function x(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}function g(e){var t=function(){var e=a.useState(x()),t=Object(m.a)(e,2),r=t[0],n=t[1],i=a.useCallback((function(e){n(x())}),[]);return a.useEffect((function(){void 0!==window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i)}),[i]),r}();return Object(O.jsx)("div",Object(f.a)(Object(f.a)({},e),{},{className:t?"".concat(e.className," bp3-dark"):e.className,children:e.children}))}var y=function(e,t){return e.reduce((function(e,t){var r=Object(m.a)(t,2),n=r[0],i=r[1];return Object(O.jsx)(n.Provider,{value:i,children:e})}),t)};var v=r(56),w=r.n(v),_=r(35),k=(r(204),r(118)),$=r(7),I=r(27),S=r(44);var L=r(69);function N(e){return Object(O.jsx)("li",{className:$.LIST_UNSTYLED,children:Object(O.jsx)("a",{rel:"noreferrer",target:"_blank",href:e.href,children:e.children})})}var D=r(110),E=r.n(D);function C(e){const{feature:t}=e;return Object(O.jsx)("address",{children:E()(Object(I.compact)(["street","housenumber","place","postcode","city","suburb","county","state","country"].map((e=>`addr:${e}`)).map((e=>t.properties[e]&&Object(O.jsx)("span",{children:t.properties[e]})))),Object(O.jsx)("span",{children:", "}))})}const T=new Set(["access","acoustic","air_conditioning","amperage","automatic_door","barrier","bicycle","blind","blind:description","braille","building:levels","capacity","centralkey","changing_table","charge","crossing","cycleway","deaf","delivery","description:payment","diet","disabled","dispensing","dog","door","drinking_water","elevator","embossed_letters","emergency","entrance","fee","female","floating","foot","gay","handrail","indoor","information","internet_access","kerb","lesbian","level","lgbtq","lit","location","male","material","max_age","min_age","opening_hours","outdoor_seating","parking","payment","ramp","represented_date","reservation","room","scale","self_service","sidewalk","sloped_curb","smoking","smoothness","socket","speech_output","step_count","stroller","surface","surveillance","tactile_paving","tactile_writing","takeaway","toilet","toilets","traffic_signals","unisex","voice_description","voltage","wheelchair","wheelchair:description","width","winter_service"]);function M(e){return T.has(e)||T.has(e.substr(0,e.indexOf(":")))}const F=new Set(["addr"]);function P(e){return F.has(e)||F.has(e.substr(0,e.indexOf(":")))}const W=Object(j.a)("table")`
  background-color: rgba(0, 0, 0, 0.05);
  margin: 1rem 0;
`;function z(e){return Object(O.jsx)(W,{className:[$.HTML_TABLE,$.HTML_TABLE_STRIPED,$.HTML_TABLE_CONDENSED].join(" "),children:e.keys.map((t=>Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:t}),Object(O.jsx)("td",{children:e.feature.properties[t]})]},t)))})}const A=e=>fetch(e).then((e=>e.json()));function B(e){const{[e.prefix?`${e.prefix}:wikidata`:"wikidata"]:t}=e.feature.properties,r=`https://query.wikidata.org/sparql?query=SELECT%20%3Fo%0AWHERE%20%7B%0A%20%20%20%20wd%3A${encodeURIComponent(t)}%20wdt%3A${e.verb}%20%3Fo.%0A%7D&format=json`,{data:n,error:i}=Object(S.a)(t?r:null,A);if(i)return null;if(!n)return null;try{const{results:t}=n,{bindings:r}=t,{o:i}=r[0],{value:s}=i,a=`${s.replace(/^http:/,"https:")}?width=200`;return Object(O.jsx)("img",{...Object(I.omit)(e,"feature","prefix","verb"),src:a,style:{...e.style,width:100}})}catch(s){return null}}function K({feature:e,prefix:t,...r}){const n=e.properties[t?`${t}:wikipedia`:"wikipedia"];if(!n)return null;const[i,s]=n.split(":");return i&&s?Object(O.jsx)("a",{href:`https://${i}.wikipedia.org/wiki/${s}`,target:"_blank",rel:"noopener noreferrer",...r}):Object(O.jsx)(O.Fragment,{children:r.children})}const Y=(e,t)=>fetch(e,t).then((e=>e.json()));function Z(){return Object(O.jsx)("div",{className:"bp3-skeleton",children:"Loading..."})}const G=["type","name","area"];function U(e){const{featureId:t}=e,r=`https://osm-api.wheelmap.tech/api/v1/${t.source}/${t.id}.json`,{data:n,error:i}=Object(S.a)(r,Y);if(i)return Object(O.jsx)(b.a,{intent:"danger",children:JSON.stringify(i)});if(!n)return Object(O.jsx)(Z,{});if(void 0!==n.error)return Object(O.jsx)(b.a,{intent:"danger",children:JSON.stringify(n)});const s=Object.keys(n.properties).sort().sort(((e,t)=>e.startsWith("name")?-1:t.startsWith("name")?1:0)).filter((e=>!G.find((t=>e.startsWith(t))))),a=s.filter(M),o=s.filter(P),c=Object(I.difference)(s,a,o),l="Point"===n.geometry.type?"node":n._id.startsWith("-")?"relation":"way",d=n._id.replace(/^-/,""),u=function(e){const t=e.properties,r=t.name||t.loc_name||t.description||t.ref;if(r)return r}(n),p=function(e){const t=e.properties,r=["studio","office","shop","room","building","landuse","route"],n=["sport","leisure","tourism","shop","amenity","junction","railway","aeroway","man_made","highway"];for(const i of n)if(t[i]&&"yes"!==t[i])return`${Object(L.humanize)(t[i])} ${t.ref||""}`;for(const i of r)if(t[i]&&"yes"!==t[i])return`${Object(L.humanize)(t[i])} ${i} ${t.ref||""}`;for(const i of r)if("yes"===t[i])return t.note||`${Object(L.humanize)(i)} ${t.ref||t.note||""}`}(n),h={margin:"0 1rem 0 1rem"};return Object(O.jsxs)(b.b,{style:{gap:"10px",maxWidth:"40rem"},children:[Object(O.jsxs)("header",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Object(O.jsxs)("div",{children:[Object(O.jsx)(b.c,{children:u||p}),u&&p&&Object(O.jsx)("p",{style:{fontWeight:"bold"},children:p}),n.properties.description&&Object(O.jsx)("p",{children:n.properties.description}),Object(O.jsx)(C,{feature:n})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)(K,{feature:n,children:Object(O.jsx)(B,{feature:n,style:h,verb:"P18"})}),Object(O.jsx)(K,{feature:n,prefix:"subject",children:Object(O.jsx)(B,{feature:n,style:h,prefix:"subject",verb:"P18"})}),Object(O.jsx)(K,{feature:n,prefix:"brand",children:Object(O.jsx)(B,{feature:n,style:h,prefix:"brand",verb:"P154"})})]})]}),Object(O.jsx)(z,{keys:a,feature:n}),Object(O.jsxs)("details",{children:[Object(O.jsx)("summary",{children:"See OpenStreetMap information"}),Object(O.jsx)("h3",{children:"OSM tags"}),Object(O.jsx)(z,{keys:c,feature:n}),Object(O.jsxs)(b.e,{className:$.LIST_UNSTYLED,children:[Object(O.jsx)(N,{href:`https://openstreetmap.org/${l}/${d}`,children:"Open on OpenStreetMap"}),"relation"!==l&&Object(O.jsx)(N,{href:`https://wheelmap.org/nodes/${"way"===l?"-":""}${d}`,children:"Open on Wheelmap"}),Object(O.jsx)(N,{href:`https://www.openstreetmap.org/edit?${l}=${d}#map=19/${n.centroid.coordinates[1]}/${n.centroid.coordinates[0]}`,children:"Edit with ID Editor"}),Object(O.jsx)(N,{href:`https://osm-api.wheelmap.tech/api/v1/${t.source}/${t.id}.geojson`,children:"Show GeoJSON"})]})]})]})}function q(e){const{featureIds:t}=e,r=Object(I.uniqBy)(t,(e=>e.id)),n=Object(O.jsx)(b.e,{className:$.LIST_UNSTYLED,children:r.map((e=>Object(O.jsx)("li",{className:$.LIST_UNSTYLED,children:Object(O.jsx)(U,{featureId:e})},`${e.source}/${e.id}`)))});return Object(O.jsx)(_.d,{latitude:e.latitude,longitude:e.longitude,closeButton:!0,closeOnClick:!1,onClose:e.onClose,anchor:"top",children:n})}var R,J=r(116),V=j.a.div(R||(R=Object(J.a)(["\n  overflow: auto;\n"]))),H=["admin","places","amenities","entrances_or_exits","elevators","ramps","pedestrian_highways","conveying","toilets","buildings","master_routes","master_route_members","routes","route_members","stop_areas","stop_area_members","platforms","stop_positions","stations"];var Q=function(e,t){return fetch(e,t).then((function(e){return e.json()}))};var X=function(){var e="https://api.mapbox.com/styles/v1/".concat("sozialhelden","/").concat("ckwdrjpmz4jox16o7libit9p4","?fresh=true&access_token=").concat("pk.eyJ1Ijoic296aWFsaGVsZGVuIiwiYSI6ImNrd2Y1M3hoMDBiY3IyeG5zbzZ3ZXR6ZXIifQ.qQ8nPyopGZKyEM4DP5aKgA"),t=Object(S.a)(e,Q),r=t.data,n=t.error;return n?{error:n}:r?{data:r}:{loading:!0}};function ee(){return a.useContext(_.b).map,null}function te(e){var t,r;const[n,{width:i,height:s}]=Object(k.a)(),o=Object(a.useRef)(null),c=Object(h.d)(),l=Object(h.e)(),d=function(e){const t=e.pathname.match(/^\/(\w+)\/([\w,:-]+)/);let r=[];if(t&&"string"===typeof t[1]&&"string"===typeof t[2]){const e=t[2];r="composite"===t[1]?Object(I.uniq)(e.split(",").sort()).map((e=>{const[t,r]=e.split(":");return{source:t,id:r}})):[{source:t[1],id:e}]}return r}(l),u=new URLSearchParams(l.search),p=u.get("lat"),b=u.get("lon"),[j,m]=Object(a.useState)({width:100,height:100,latitude:p&&parseFloat(p)||52.5,longitude:b&&parseFloat(b)||13.3,zoom:p&&b?18:10});Object(a.useLayoutEffect)((()=>{const e={...j,width:i,height:s};m(e)}),[i,s]);const x=Object(a.useCallback)((e=>{var t,r;console.log(e);const n=null===e||void 0===e||null===(t=e.features)||void 0===t?void 0:t.length;if(n||c.push("/"),1!==n)c.push(`/composite/${null===(r=e.features)||void 0===r?void 0:r.map((e=>[e.source,e.properties.id].join(":"))).join(",")}?lon=${e.lngLat[0]}&lat=${e.lngLat[1]}`);else{var i;const t=null===(i=e.features)||void 0===i?void 0:i[0];t&&c.push(`/${t.source}/${t.properties.id}?lon=${e.lngLat[0]}&lat=${e.lngLat[1]}`)}}),[c]),g=Object(a.useCallback)((()=>{c.push("/")}),[c]),y=Object(a.useCallback)(((e,t)=>{m({...j,...e})}),[m,j]),v=X(),w=a.useMemo((()=>{var e,t;return(null===(e=v.data)||void 0===e?void 0:e.layers)&&function(e){return e.filter((function(e){var t;return null===(t=e.id)||void 0===t?void 0:t.startsWith("osm-")})).map((function(e){var t=H.find((function(t){var r;return null===(r=e["source-layer"])||void 0===r?void 0:r.startsWith(t)}));return Object(f.a)(Object(f.a)({},e),{},{source:t,"source-layer":"default"})})).filter((function(e){return e.source}))}(null===(t=v.data)||void 0===t?void 0:t.layers)}),[v]);return Object(O.jsxs)(V,{ref:n,className:e.className,style:{flex:1,display:!1===e.visible?"none":"block",position:"relative"},children:[Object(O.jsxs)(_.f,{...j,mapboxApiAccessToken:"pk.eyJ1Ijoic296aWFsaGVsZGVuIiwiYSI6ImNrd2Y1M3hoMDBiY3IyeG5zbzZ3ZXR6ZXIifQ.qQ8nPyopGZKyEM4DP5aKgA",onViewportChange:y,interactiveLayerIds:null===(t=v.data)||void 0===t||null===(r=t.layers)||void 0===r?void 0:r.map((e=>e.id)).filter((e=>e.startsWith("osm-"))),onClick:x,mapStyle:"mapbox://styles/mapbox/light-v10",ref:o,children:[H.map((e=>Object(O.jsx)(_.e,{type:"vector",tiles:[`https://osm-api.wheelmap.tech/api/v1/${e}.mvt?limit=10000&bbox={bbox-epsg-3857}&epsg=3857`],id:e},e))),null===w||void 0===w?void 0:w.map((e=>Object(O.jsx)(_.a,{...e},e.id))),p&&b&&d.length>0&&Object(O.jsx)(q,{featureIds:d,latitude:Number.parseFloat(p),longitude:Number.parseFloat(b),onClose:g}),Object(O.jsx)(ee,{}),Object(O.jsx)(_.c,{style:{right:"1rem",top:"1rem"}})]}),e.children]})}w.a.workerClass=r(231).default,u.a.onlyShowFocusOnTabs();const re=j.a.div`
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: row;
  align-items: stretch;
`;var ne=function(){const e=[],t=Object(h.d)(),r=Object(h.e)(),n=a.useCallback((e=>{const n=`/features/${e}`;t.push(`${n}${r.search}`)}),[t,r]),i=Object(O.jsx)(te,{featureId:void 0,onSelectFeature:n,visible:!0}),s=Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(re,{children:i})}),c=o.a.useMemo((function(){return[{combo:"mod+z",global:!0,label:"Undo",onKeyDown:function(){alert("!!")},allowInInput:!1,preventDefault:!0},{global:!0,combo:"mod+shift+z",label:"Redo",onKeyDown:function(){alert("!!")},allowInInput:!1,preventDefault:!0}]}),[]);return Object(O.jsx)(p.b,{children:Object(O.jsx)(b.d,{hotkeys:c,children:({handleKeyDown:t,handleKeyUp:r})=>Object(O.jsx)(g,{style:{height:"100%",display:"flex",flexDirection:"column"},onKeyDown:t,onKeyUp:r,children:y(e,s)})})})},ie=(r(235),function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,244)).then((function(t){var r=t.getCLS,n=t.getFID,i=t.getFCP,s=t.getLCP,a=t.getTTFB;r(e),n(e),i(e),s(e),a(e)}))});i.a.config(),Object(s.a)(),Object(s.b)(),l.a.render(Object(O.jsx)(o.a.StrictMode,{children:Object(O.jsx)(d.a,{basename:"/planet-accessibility-explorer",children:Object(O.jsx)(ne,{})})}),document.getElementById("root")),ie()}},[[236,1,2]]]);
//# sourceMappingURL=main.25b7df45.chunk.js.map