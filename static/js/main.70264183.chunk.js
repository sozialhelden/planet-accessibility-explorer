(this["webpackJsonpplanet-accessibility-explorer"]=this["webpackJsonpplanet-accessibility-explorer"]||[]).push([[0],{182:function(e,t,n){},234:function(e,t,n){},235:function(e,t,n){"use strict";n.r(t);var o=n(107),a=n.n(o),s=n(81),r=n(0),i=n.n(r),c=n(20),l=n.n(c),u=n(115),d=n(242),h=n(240),b=n(241),j=n(9),p=n(64),m=(n(182),n(43)),f=n(35),O=n(5);function v(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}function x(e){var t=function(){var e=r.useState(v()),t=Object(f.a)(e,2),n=t[0],o=t[1],a=r.useCallback((function(e){o(v())}),[]);return r.useEffect((function(){void 0!==window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a)}),[a]),n}();return Object(O.jsx)("div",Object(m.a)(Object(m.a)({},e),{},{className:t?"".concat(e.className," bp3-dark"):e.className,children:e.children}))}var g=function(e,t){return e.reduce((function(e,t){var n=Object(f.a)(t,2),o=n[0],a=n[1];return Object(O.jsx)(o.Provider,{value:a,children:e})}),t)};var y,w=n(53),I=n.n(w),k=n(37),C=(n(203),n(116)),D=n(108),M=p.a.div(y||(y=Object(D.a)(["\n  overflow: auto;\n"]))),N=n(10),S=n(65);const _=(e,t)=>fetch(e,t).then((e=>e.json()));function F(){return Object(O.jsx)("div",{className:"bp3-skeleton",children:"Loading..."})}function L(e){const{featureId:t}=e,n=`https://osm-api.wheelmap.tech/api/v1/${t.source}/${t.id}.json`,{data:o,error:a}=Object(S.a)(n,_);if(a)return Object(O.jsx)(b.a,{intent:"danger",children:JSON.stringify(a)});if(!o)return Object(O.jsx)(F,{});const s=Object.keys(o.properties).sort().sort(((e,t)=>t.startsWith("name")?-1:e.startsWith("name")?1:0));return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("h2",{children:[t.source," / ",t.id]}),Object(O.jsx)("table",{children:s.map((e=>Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:e}),Object(O.jsx)("td",{children:o.properties[e]})]},e)))})]})}function $(e){const{featureIds:t}=e,n=Object(O.jsx)(b.c,{children:t.map((e=>Object(O.jsx)("li",{className:N.LIST_UNSTYLED,children:Object(O.jsx)(L,{featureId:e})},`${e.source}/${e.id}`)))});return Object(O.jsx)(k.c,{latitude:e.latitude,longitude:e.longitude,closeButton:!0,closeOnClick:!1,onClose:e.onClose,anchor:"top",children:n})}var K=["admin","places","amenities","entrances_or_exits","elevators","ramps","pedestrian_highways","conveying","toilets","buildings","master_routes","master_route_members","routes","route_members","stop_areas","stop_area_members","platforms","stop_positions","stations"];var Z=n(114);var z=function(e,t){return fetch(e,t).then((function(e){return e.json()}))};var G=function(){var e="https://api.mapbox.com/styles/v1/".concat("sozialhelden","/").concat("ckwdrjpmz4jox16o7libit9p4","?fresh=true&access_token=").concat("pk.eyJ1Ijoic296aWFsaGVsZGVuIiwiYSI6ImNrd2Y1M3hoMDBiY3IyeG5zbzZ3ZXR6ZXIifQ.qQ8nPyopGZKyEM4DP5aKgA"),t=Object(S.a)(e,z),n=t.data,o=t.error;return o?{error:o}:n?{data:n}:{loading:!0}};function P(){return r.useContext(k.b).map,null}function E(e){const[t,{width:n,height:o}]=Object(C.a)(),a=Object(r.useRef)(null),[s,i]=Object(r.useState)({width:100,height:100,latitude:52.5,longitude:13.3,zoom:10});Object(r.useLayoutEffect)((()=>{const e={...s,width:n,height:o};i(e)}),[n,o]);const c=Object(j.d)(),l=Object(j.e)(),u=function(e){const t=e.pathname.match(/^\/(\w+)\/([\w,:-]+)/);let n=[];if(t&&"string"===typeof t[1]&&"string"===typeof t[2]){const e=t[2];n="composite"===t[1]?Object(Z.uniq)(e.split(",").sort()).map((e=>{const[t,n]=e.split(":");return{source:t,id:n}})):[{source:t[1],id:e}]}return n}(l),d=new URLSearchParams(l.search),h=d.get("lat"),b=d.get("lon"),p=Object(r.useCallback)((e=>{var t;console.log(e),(null===e||void 0===e||null===(t=e.features)||void 0===t?void 0:t.length)?c.push(`/composite/${e.features.map((e=>[e.source,e.properties.id].join(":"))).join(",")}?lon=${e.lngLat[0]}&lat=${e.lngLat[1]}`):c.push("/")}),[c]),f=Object(r.useCallback)((()=>{c.push("/")}),[c]),v=Object(r.useCallback)(((e,t)=>{i({...s,...e})}),[i,s]),x=G(),g=r.useMemo((()=>{var e,t;return(null===(e=x.data)||void 0===e?void 0:e.layers)&&function(e){return e.filter((function(e){var t;return null===(t=e.id)||void 0===t?void 0:t.startsWith("osm-")})).map((function(e){var t=K.find((function(t){var n;return null===(n=e["source-layer"])||void 0===n?void 0:n.startsWith(t)}));return Object(m.a)(Object(m.a)({},e),{},{source:t,"source-layer":"default"})})).filter((function(e){return e.source}))}(null===(t=x.data)||void 0===t?void 0:t.layers)}),[x]);return Object(O.jsxs)(M,{ref:t,className:e.className,style:{flex:1,display:!1===e.visible?"none":"block",position:"relative"},children:[Object(O.jsxs)(k.e,{...s,mapboxApiAccessToken:"pk.eyJ1Ijoic296aWFsaGVsZGVuIiwiYSI6ImNrd2Y1M3hoMDBiY3IyeG5zbzZ3ZXR6ZXIifQ.qQ8nPyopGZKyEM4DP5aKgA",onViewportChange:v,interactiveLayerIds:["osm-entrance-icon","osm-toilet","osm-surface-outline","osm-surface-fill","osm-poi-wheelchair-circle","osm-wheelchair-yes-label","osm-wheelchair-no-label","osm-wheelchair-limited-label","osm-pedestrian-highways-wheelchair-outline","osm-building-wheelchair-outline"],onClick:p,mapStyle:"mapbox://styles/mapbox/light-v10",ref:a,children:[K.map((e=>Object(O.jsx)(k.d,{type:"vector",tiles:[`https://osm-api.wheelmap.tech/api/v1/${e}.mvt?limit=10000&bbox={bbox-epsg-3857}&epsg=3857`],id:e},e))),null===g||void 0===g?void 0:g.map((e=>Object(O.jsx)(k.a,{...e},e.id))),h&&b&&u.length>0&&Object(O.jsx)($,{featureIds:u,latitude:Number.parseFloat(h),longitude:Number.parseFloat(b),onClose:f}),Object(O.jsx)(P,{})]}),e.children]})}I.a.workerClass=n(230).default,d.a.onlyShowFocusOnTabs();const Y=p.a.div`
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: row;
  align-items: stretch;
`;var T=function(){const e=[],t=Object(j.d)(),n=Object(j.e)(),o=r.useCallback((e=>{const o=`/features/${e}`;t.push(`${o}${n.search}`)}),[t,n]),a=Object(O.jsx)(E,{featureId:void 0,onSelectFeature:o,visible:!0}),s=Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(Y,{children:a})}),c=i.a.useMemo((function(){return[{combo:"mod+z",global:!0,label:"Undo",onKeyDown:function(){alert("!!")},allowInInput:!1,preventDefault:!0},{global:!0,combo:"mod+shift+z",label:"Redo",onKeyDown:function(){alert("!!")},allowInInput:!1,preventDefault:!0}]}),[]);return Object(O.jsx)(h.b,{children:Object(O.jsx)(b.b,{hotkeys:c,children:({handleKeyDown:t,handleKeyUp:n})=>Object(O.jsx)(x,{style:{height:"100%",display:"flex",flexDirection:"column"},onKeyDown:t,onKeyUp:n,children:g(e,s)})})})},W=(n(234),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,243)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),o(e),a(e),s(e),r(e)}))});a.a.config(),Object(s.a)(),Object(s.b)(),l.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(u.a,{basename:"/planet-accessibility-explorer",children:Object(O.jsx)(T,{})})}),document.getElementById("root")),W()}},[[235,1,2]]]);
//# sourceMappingURL=main.70264183.chunk.js.map